<!DOCTYPE html>
<html>
<head>
    <title>Author a Story with N3</title>
    <link rel="stylesheet" href="css/jquery-ui.css" type="text/css" />
    <link rel="stylesheet" href="css/colorpicker.css" type="text/css" />
    <link rel="stylesheet" href="css/n3-edit.css" type="text/css" />
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/jquery-ui.min.js"></script>
    <script type="text/javascript" src="js/jquery.json-2.3.min.js"></script>
    <script type="text/javascript" src="js/colorpicker.js"></script>
    <script type="text/javascript" src="js/d3.min.js"></script>
    <script type="text/javascript" src="js/n3.js"></script>
    <script type="text/javascript" src="js/n3-edit.js"></script>
</head>
<body>
    <div id="n3-ui_visDialog" title="Visualizations">
    	<p>To begin, please paste your javascript <code>n3.vis</code> wrappers in the textbox below. Feel free to enter multiple visualizations at once.</p>
    	<p><textarea name="vis" id="vis">
    	    var data = {
                thirteen:  d3.range(17, 88, 13),
                seventeen: d3.range(13, 88, 17),
                nineteen:  d3.range(11, 88, 19)
            };
            var width = 700
            var height = 400

            var vis = n3.vis('simpleTest1')
                            .stage('#stage', width, height)
                            .data(data)
                            .state('numberRange', ['thirteen', 'seventeen', 'nineteen'])
                            .const('sx', function() {
                                return d3.scale.linear()
                                                .domain([0, vis.data()[vis.state('numberRange')].length])
                                                .range([0, vis.width()])
                            })
                            .const('sy', function() {
                                return d3.scale.linear()
                                                .domain([0, 88])
                                                .range([0, vis.height()])
                            })
                            .render(renderVis)

            function renderVis() {
                var svg = this.stage()

                var selBar = svg.selectAll('rect.vis')
                                    .data(this.data()[this.state('numberRange')])

                selBar.enter().append('svg:rect')
                        .attr('x', function(d, i) { return vis.const('sx')()(i) })
                        .attr('y', this.height())
                        .attr('class', 'vis')
                        .attr('width', 80)
                        .attr('height', this.const('sy')())
                        .style('fill', 'steelblue')

                selBar.transition()
                        .duration(1000)
                        .delay(function(d, i) { return i * 125 })
                        .attr('y', function(d) { return vis.height() - vis.const('sy')()(d) })
                        .attr('height', this.const('sy')())
                        .style('fill', 'steelblue')

                selBar.exit().transition()
                        .duration(1000)
                        .attr('y', this.height())
                        .remove()
            }
    	</textarea></p>
    </div>
        
    <div id="n3-ui_stage">
        
    </div>
    
    <div id="n3-ui_bottom_panel">
        <input type="button" class="new button-left button" name="n3-ui_startScene" value="New Scene" id="n3-ui_startScene" onclick="editScene();" />
        
        <input type="button" class="end button-left button" name="n3-ui_endScene" value="End Scene" id="n3-ui_endScene" onclick="endScene();" style="display: none;" />
        
        <div id="n3-ui_palette" style="display: none;">
            <a href="#" onclick="toggleShape(this, SHAPES.ELLIPSE);"><img src="imgs/draw-circle.png" src="Draw Circle" /></a>
            <!-- <a href="#" onclick="toggleShape(this, SHAPES.ELLIPSE);"><img src="imgs/draw-ellipse.png" src="Draw Ellipse" /></a> -->
            <a href="#" onclick="toggleShape(this, SHAPES.RECTANGLE);"><img src="imgs/draw-rect.png" src="Draw Rect" /></a>
            <a href="#" onclick="toggleShape(this, SHAPES.LINE);"><img src="imgs/draw-line.png" src="Draw Line" /></a>
        </div>
        
        <input type="button" class="play button" name="n3-ui_play" value="Play Story" id="n3-ui_play" onclick="playStory();" />
        
        <input type="button" class="export button" name="n3-ui_export" value="Export Story" id="n3-ui_export" onclick="exportStory();" />
    </div>
    
    <div id="n3-ui_side_panel">
        
    </div>
    
    <div id="n3-ui_triggerDialog" title="Triggers">
        <ul>
            <li id="triggerTemplate" style="display: none;">
                <p>Trigger type: 
                <select class="trigger_type" onchange="chooseTrigger(this);">
                    <option value="">Select...</option>
                    <option value="state">State</option>
                    <!-- <option value="dom">Page Element</option> -->
                    <option value="timeline">Timeline</option>
                    <option value="delay">After previous delay</option>
                    <option value="or">Or</option>
                    <option value="and">And</option>
                </select>
                
                <a href="#" onclick="addSubTrigger(this);" class="add_sub_trigger" style="display: none;">Add</a>
                </p>
                
                <p class="state" style="display: none;">
                    <select class="where" onchange="$(this).nextAll('select.value').hide(); if($(this).val() != '') $(this).nextAll('select.value.' + $(this).val() + ':first').show();">
                        <option value="">Select state...</option>
                    </select>
                    
                    <select class="condition">
                        <option value="is">is</option>
                        <option value="not">not</option>
                        <option value="gt">&gt;</option>
                        <option value="gte">&gt;=</option>
                        <option value="lt">&lt;</option>
                        <option value="lte">&lt;=</option>
                    </select>
                    
                    <select class="value">
                        <option value="">Select value...</option>
                    </select>
                </p>
                
                <p class="dom" style="display: none;"><input type="button" class="on" value="Select element" /></p>
                
                <p class="timeline" style="display: none;">Elapsed time
                    <input type="hidden" class="where" value="elapsed" />
                    <select class="condition">
                        <option value="is">is</option>
                        <option value="not">not</option>
                        <option value="gt">&gt;</option>
                        <option value="gte">&gt;=</option>
                        <option value="lt">&lt;</option>
                        <option value="lte">&lt;=</option>
                    </select>
                    
                    <input type="text" class="value" value="" size="2" />ms
                </p>
                
                <p class="delay" style="display: none;"><input type="hidden" class="where" value="delay" /><input type="text" class="value" value="" size="2" />ms</p>
            </li>
    	<!-- <p>Please enter triggers for this member using n3 syntax.</p>
    	       <p><textarea name="triggers" id="triggers"></textarea></p>
    	       <p><input type="button" name="n3-ui_visSave" value="Save" id="n3-ui_visSave" onclick="saveTriggers();" /></p> -->
    </div>
    
    <div id="n3-ui_stylesDialog" title="Styles">
    	<p>The following styles are available for the selected annotation.</p>
    	
    	<p><span class="style_desc">Fill opacity and color:</span> <span id="fill_opacity"></span> <span id="fill_color"></span></p>
    	
    	<p><span class="style_desc">Border width and color:</span> <span id="stroke_width"></span> <span id="stroke_color"></span></p>
    </div>
    
    <div id="n3-ui_exportDialog" title="Export">
    	<p><textarea name="export" id="export"></textarea></p>
    </div>
</body>
</html>